---
layout: page
title: Notes
---

This is where I keep notes for things I keep revisiting throughout my work.

# Unity game dev

## Animations

### Importing

- "bake into pose" root transform changes that shouldn't be applied to the gameobject on each animation.

### Mixamo

Downloading animations "without skin" prevents wasting memory with unnecessary models.
However, the avatar generated by Unity for these won't work properly.
That can be fixed by downloading the default Mixamo character (Y Bot) in T-pose and generating an avatar from it, which can then be used with "without skin" Mixamo animations.

### Movement without foot sliding

Goal: set up player movement that is script controlled (as opposed to root motion based, for better responsiveness), but sync up animations to minimize discrepancies such as foot sliding.

1. Set up blend tree
   - 2D simple directional (no idle animation)
   - 8 directional animations (minimize velocity difference when blending - for example, blending a forward with a sideways animation can result in diagonal movement that is slower than either of the other animations individually. Blending animation root motion is poorly documented.)
   - Adjust animation speeds so that each has a resulting velocity of 1m/s
     1. Compute positions -> Velocity XZ
     2. Divide animation speed by norm of velocity
   - Reset animation positions to unit circle coordinates
   - Set blend tree animation direction through X and Y parameters connected to user input
   - Adjust blend tree speed by setting a parameter to be equal to the player's speed
2. Transition to/from idle animation
   - Idle animation cannot be in blend tree as the blend tree's speed will be modified
   - Blending between idle and movement animations is unreliable anyway in terms of resulting velocity (unpredictable, non-linear)

This is what the resulting blend tree looks like:

![Blend tree]({% link assets/notes/unity-movement-blend-tree.jpg %})

Downsides of this approach:

- Cannot interpolate

More info at <https://kybernetik.com.au/animancer/docs/manual/blending/mixers/#synchronisation>

## Blender

## Submodules

test test test

## Color banding

[Fix color banding](https://forum.unity.com/threads/horrible-color-banding-for-lighting-fog.912368/#post-9386285) by checking "enable dithering" in the camera inspector.

### Settings

- Disable saving `.blend1` files

### Unity interop

- Store `.blend` files directly inside the Unity project's "Assets" folder
- There doesn't seem to be a way to store textures in `.blend` file, so keep them in "Assets" folder and use them in both Blender and Unity

## LODs

- Only the last LOD matters
- Impostors > LOD meshes
- Advancements like Nanite can change 3D lore fast

Based on <https://medium.com/@jasonbooth_86226/when-to-make-lods-c3109c35b802>

## Math

### Frame rate independent lerp

Use a [frame rate independent](https://marcospereira.me/2022/08/24/lerp-how-to-frame-rate-independent/) form of linear interpolation instead of the default `Mathf.Lerp()`.

Ready to use code should be available in the [Unity utilities repo](https://github.com/marcospgp/unity-utilities).

## Utilities repo

<https://github.com/marcospgp/unity-utilities>

# General development

## Git

### Commit without a message

`git add -A && git commit --allow-empty-message -m '' && git push`

### Submodules

Git submodules are a nice way of setting up project dependencies.

You can add a dependency into a repo by running (from any subfolder):

`git submodule add https://github.com/marcospgp/steamworksnt.git <target-folder-name>`

To update dependencies or download them after a fresh `git clone`, use:

`git submodule update --init --recursive --merge --remote`
